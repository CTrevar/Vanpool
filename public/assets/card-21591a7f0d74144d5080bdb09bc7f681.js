!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.card=t()}}(function(){return function t(e,n,i){function o(r,a){if(!n[r]){if(!e[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+r+"'")}var c=n[r]={exports:{}};e[r][0].call(c.exports,function(t){var n=e[r][1][t];return o(n?n:t)},c,c.exports,t,e,n,i)}return n[r].exports}for(var s="function"==typeof require&&require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(){(function(){var t,e,n,i,o,s,r,a,l,c,u,h,d,p,f,g,m,v,y,b,w=[].slice,x=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};t=jQuery,t.payment={},t.payment.fn={},t.fn.payment=function(){var e,n;return n=arguments[0],e=2<=arguments.length?w.call(arguments,1):[],t.payment.fn[n].apply(this,e)},o=/(\d{1,4})/g,i=[{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5(018|0[23]|[68])|6(39|7))/,format:o,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",pattern:/^600/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",pattern:/^5019/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:o,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[0-5]/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",pattern:/^3[0689]/,format:o,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^6([045]|22)/,format:o,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^(62|88)/,format:o,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",pattern:/^35/,format:o,length:[16],cvcLength:[3],luhn:!0}],e=function(t){var e,n,o;for(t=(t+"").replace(/\D/g,""),n=0,o=i.length;o>n;n++)if(e=i[n],e.pattern.test(t))return e},n=function(t){var e,n,o;for(n=0,o=i.length;o>n;n++)if(e=i[n],e.type===t)return e},d=function(t){var e,n,i,o,s,r;for(i=!0,o=0,n=(t+"").split("").reverse(),s=0,r=n.length;r>s;s++)e=n[s],e=parseInt(e,10),(i=!i)&&(e*=2),e>9&&(e-=9),o+=e;return o%10===0},h=function(t){var e;return null!=t.prop("selectionStart")&&t.prop("selectionStart")!==t.prop("selectionEnd")?!0:("undefined"!=typeof document&&null!==document&&null!=(e=document.selection)&&"function"==typeof e.createRange?e.createRange().text:void 0)?!0:!1},p=function(e){return setTimeout(function(){var n,i;return n=t(e.currentTarget),i=n.val(),i=t.payment.formatCardNumber(i),n.val(i)})},a=function(n){var i,o,s,r,a,l,c;return s=String.fromCharCode(n.which),!/^\d+$/.test(s)||(i=t(n.currentTarget),c=i.val(),o=e(c+s),r=(c.replace(/\D/g,"")+s).length,l=16,o&&(l=o.length[o.length.length-1]),r>=l||null!=i.prop("selectionStart")&&i.prop("selectionStart")!==c.length)?void 0:(a=o&&"amex"===o.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,a.test(c)?(n.preventDefault(),setTimeout(function(){return i.val(c+" "+s)})):a.test(c+s)?(n.preventDefault(),setTimeout(function(){return i.val(c+s+" ")})):void 0)},s=function(e){var n,i;return n=t(e.currentTarget),i=n.val(),8!==e.which||null!=n.prop("selectionStart")&&n.prop("selectionStart")!==i.length?void 0:/\d\s$/.test(i)?(e.preventDefault(),setTimeout(function(){return n.val(i.replace(/\d\s$/,""))})):/\s\d?$/.test(i)?(e.preventDefault(),setTimeout(function(){return n.val(i.replace(/\s\d?$/,""))})):void 0},f=function(e){return setTimeout(function(){var n,i;return n=t(e.currentTarget),i=n.val(),i=t.payment.formatExpiry(i),n.val(i)})},l=function(e){var n,i,o;return i=String.fromCharCode(e.which),/^\d+$/.test(i)?(n=t(e.currentTarget),o=n.val()+i,/^\d$/.test(o)&&"0"!==o&&"1"!==o?(e.preventDefault(),setTimeout(function(){return n.val("0"+o+" / ")})):/^\d\d$/.test(o)?(e.preventDefault(),setTimeout(function(){return n.val(""+o+" / ")})):void 0):void 0},c=function(e){var n,i,o;return i=String.fromCharCode(e.which),/^\d+$/.test(i)?(n=t(e.currentTarget),o=n.val(),/^\d\d$/.test(o)?n.val(""+o+" / "):void 0):void 0},u=function(e){var n,i,o;return o=String.fromCharCode(e.which),"/"===o||" "===o?(n=t(e.currentTarget),i=n.val(),/^\d$/.test(i)&&"0"!==i?n.val("0"+i+" / "):void 0):void 0},r=function(e){var n,i;return n=t(e.currentTarget),i=n.val(),8!==e.which||null!=n.prop("selectionStart")&&n.prop("selectionStart")!==i.length?void 0:/\s\/\s\d?$/.test(i)?(e.preventDefault(),setTimeout(function(){return n.val(i.replace(/\s\/\s\d?$/,""))})):void 0},y=function(t){var e;return t.metaKey||t.ctrlKey?!0:32===t.which?!1:0===t.which?!0:t.which<33?!0:(e=String.fromCharCode(t.which),!!/[\d\s]/.test(e))},m=function(n){var i,o,s,r;return i=t(n.currentTarget),s=String.fromCharCode(n.which),/^\d+$/.test(s)&&!h(i)?(r=(i.val()+s).replace(/\D/g,""),o=e(r),o?r.length<=o.length[o.length.length-1]:r.length<=16):void 0},v=function(e){var n,i,o;return n=t(e.currentTarget),i=String.fromCharCode(e.which),/^\d+$/.test(i)&&!h(n)?(o=n.val()+i,o=o.replace(/\D/g,""),o.length>6?!1:void 0):void 0},g=function(e){var n,i,o;return n=t(e.currentTarget),i=String.fromCharCode(e.which),/^\d+$/.test(i)&&!h(n)?(o=n.val()+i,o.length<=4):void 0},b=function(e){var n,o,s,r,a;return n=t(e.currentTarget),a=n.val(),r=t.payment.cardType(a)||"unknown",n.hasClass(r)?void 0:(o=function(){var t,e,n;for(n=[],t=0,e=i.length;e>t;t++)s=i[t],n.push(s.type);return n}(),n.removeClass("unknown"),n.removeClass(o.join(" ")),n.addClass(r),n.toggleClass("identified","unknown"!==r),n.trigger("payment.cardType",r))},t.payment.fn.formatCardCVC=function(){return this.payment("restrictNumeric"),this.on("keypress",g),this},t.payment.fn.formatCardExpiry=function(){return this.payment("restrictNumeric"),this.on("keypress",v),this.on("keypress",l),this.on("keypress",u),this.on("keypress",c),this.on("keydown",r),this.on("change",f),this.on("input",f),this},t.payment.fn.formatCardNumber=function(){return this.payment("restrictNumeric"),this.on("keypress",m),this.on("keypress",a),this.on("keydown",s),this.on("keyup",b),this.on("paste",p),this.on("change",p),this.on("input",p),this.on("input",b),this},t.payment.fn.restrictNumeric=function(){return this.on("keypress",y),this},t.payment.fn.cardExpiryVal=function(){return t.payment.cardExpiryVal(t(this).val())},t.payment.cardExpiryVal=function(t){var e,n,i,o;return t=t.replace(/\s/g,""),o=t.split("/",2),e=o[0],i=o[1],2===(null!=i?i.length:void 0)&&/^\d+$/.test(i)&&(n=(new Date).getFullYear(),n=n.toString().slice(0,2),i=n+i),e=parseInt(e,10),i=parseInt(i,10),{month:e,year:i}},t.payment.validateCardNumber=function(t){var n,i;return t=(t+"").replace(/\s+|-/g,""),/^\d+$/.test(t)?(n=e(t),n?(i=t.length,x.call(n.length,i)>=0&&(n.luhn===!1||d(t))):!1):!1},t.payment.validateCardExpiry=function(e,n){var i,o,s;return"object"==typeof e&&"month"in e&&(s=e,e=s.month,n=s.year),e&&n?(e=t.trim(e),n=t.trim(n),/^\d+$/.test(e)&&/^\d+$/.test(n)&&e>=1&&12>=e?(2===n.length&&(n=70>n?"20"+n:"19"+n),4!==n.length?!1:(o=new Date(n,e),i=new Date,o.setMonth(o.getMonth()-1),o.setMonth(o.getMonth()+1,1),o>i)):!1):!1},t.payment.validateCardCVC=function(e,i){var o,s;return e=t.trim(e),/^\d+$/.test(e)?(o=n(i),null!=o?(s=e.length,x.call(o.cvcLength,s)>=0):e.length>=3&&e.length<=4):!1},t.payment.cardType=function(t){var n;return t?(null!=(n=e(t))?n.type:void 0)||null:null},t.payment.formatCardNumber=function(n){var i,o,s,r;return(i=e(n))?(s=i.length[i.length.length-1],n=n.replace(/\D/g,""),n=n.slice(0,s),i.format.global?null!=(r=n.match(i.format))?r.join(" "):void 0:(o=i.format.exec(n),null!=o?(o.shift(),o=t.grep(o,function(t){return t}),o.join(" ")):void 0)):n},t.payment.formatExpiry=function(t){var e,n,i,o;return(n=t.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(e=n[1]||"",i=n[2]||"",o=n[3]||"",(o.length>0||i.length>0&&!/\ \/?\ ?/.test(i))&&(i=" / "),1===e.length&&"0"!==e&&"1"!==e&&(e="0"+e,i=" / "),e+i+o):""}}).call(this)},{}],2:[function(t){var e,n,i=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},o=[].slice;t("jquery.payment"),e=jQuery,e.card={},e.card.fn={},e.fn.card=function(t){return e.card.fn.construct.apply(this,t)},n=function(){function t(t,n){return this.options=e.extend(!0,{},this.defaults,n),e.extend(this.options.messages,e.card.messages),e.extend(this.options.values,e.card.values),this.$el=e(t),this.options.container?(this.$container=e(this.options.container),this.render(),this.attachHandlers(),void this.handleInitialValues()):void console.log("Please provide a container")}return t.prototype.cardTemplate='<div class="card-container">\n    <div class="card">\n        <div class="front">\n                <div class="card-logo visa">visa</div>\n                <div class="card-logo mastercard">MasterCard</div>\n                <div class="card-logo amex"></div>\n                <div class="card-logo discover">discover</div>\n            <div class="lower">\n                <div class="shiny"></div>\n                <div class="cvc display">{{cvc}}</div>\n                <div class="number display">{{number}}</div>\n                <div class="name display">{{name}}</div>\n                <div class="expiry display" data-before="{{monthYear}}" data-after="{{validDate}}">{{expiry}}</div>\n            </div>\n        </div>\n        <div class="back">\n            <div class="bar"></div>\n            <div class="cvc display">{{cvc}}</div>\n            <div class="shiny"></div>\n        </div>\n    </div>\n</div>',t.prototype.template=function(t,e){return t.replace(/\{\{(.*?)\}\}/g,function(t,n){return e[n]})},t.prototype.cardTypes=["maestro","dinersclub","laser","jcb","unionpay","discover","mastercard","amex","visa"],t.prototype.defaults={formatting:!0,formSelectors:{numberInput:'input[id="card_number"]',expiryInput:'input[id="expiry"]',cvcInput:'input[id="cvv2"]',nameInput:'input[id="holder_name"]'},cardSelectors:{cardContainer:".card-container",card:".card",numberDisplay:".number",expiryDisplay:".expiry",cvcDisplay:".cvc",nameDisplay:".name"},messages:{validDate:"valid\nthru",monthYear:"month/year"},values:{number:"&bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull;",cvc:"&bull;&bull;&bull;",expiry:"&bull;&bull;/&bull;&bull;",name:"Full Name"},classes:{valid:"card-valid",invalid:"card-invalid"}},t.prototype.render=function(){var t,n;return this.$container.append(this.template(this.cardTemplate,e.extend({},this.options.messages,this.options.values))),e.each(this.options.cardSelectors,function(t){return function(e,n){return t["$"+e]=t.$container.find(n)}}(this)),e.each(this.options.formSelectors,function(t){return function(n,i){var o;return o=t.options[n]?e(t.options[n]):t.$el.find(i),o.length||console.error("Card can't find a "+n+" in your form."),t["$"+n]=o}}(this)),this.options.formatting&&(this.$numberInput.payment("formatCardNumber"),this.$cvcInput.payment("formatCardCVC"),1===this.$expiryInput.length&&this.$expiryInput.payment("formatCardExpiry")),this.options.width&&(t=parseInt(this.$cardContainer.css("width")),this.$cardContainer.css("transform","scale("+this.options.width/t+")")),("undefined"!=typeof navigator&&null!==navigator?navigator.userAgent:void 0)&&(n=navigator.userAgent.toLowerCase(),-1!==n.indexOf("safari")&&-1===n.indexOf("chrome")&&this.$card.addClass("safari")),new Function("/*@cc_on return @_jscript_version; @*/")()?this.$card.addClass("ie-10"):void 0},t.prototype.attachHandlers=function(){var t;return this.$numberInput.bindVal(this.$numberDisplay,{fill:!1,filters:this.validToggler("cardNumber")}).on("payment.cardType",this.handle("setCardType")),t=[function(t){return t.replace(/(\s+)/g,"")}],1===this.$expiryInput.length&&t.push(this.validToggler("cardExpiry")),this.$expiryInput.bindVal(this.$expiryDisplay,{join:function(t){return 2===t[0].length||t[1]?"/":""},filters:t}),this.$cvcInput.bindVal(this.$cvcDisplay,{filters:this.validToggler("cardCVC")}).on("focus",this.handle("flipCard")).on("blur",this.handle("flipCard")),this.$nameInput.bindVal(this.$nameDisplay,{fill:!1,filters:this.validToggler("cardHolderName"),join:" "}).on("keydown",this.handle("captureName"))},t.prototype.handleInitialValues=function(){return e.each(this.options.formSelectors,function(t){return function(e){var n;return n=t["$"+e],n.val()?(n.trigger("paste"),setTimeout(function(){return n.trigger("keyup")})):void 0}}(this))},t.prototype.handle=function(t){return function(n){return function(i){var o,s;return o=e(i.currentTarget),s=Array.prototype.slice.call(arguments),s.unshift(o),n.handlers[t].apply(n,s)}}(this)},t.prototype.validToggler=function(t){var n;return"cardExpiry"===t?n=function(t){var n;return n=e.payment.cardExpiryVal(t),e.payment.validateCardExpiry(n.month,n.year)}:"cardCVC"===t?n=function(t){return function(n){return e.payment.validateCardCVC(n,t.cardType)}}(this):"cardNumber"===t?n=function(t){return e.payment.validateCardNumber(t)}:"cardHolderName"===t&&(n=function(t){return""!==t}),function(t){return function(e,i,o){var s;return s=n(e),t.toggleValidClass(i,s),t.toggleValidClass(o,s),e}}(this)},t.prototype.toggleValidClass=function(t,e){return t.toggleClass(this.options.classes.valid,e),t.toggleClass(this.options.classes.invalid,!e)},t.prototype.handlers={setCardType:function(t,e,n){return this.$card.hasClass(n)?void 0:(this.$card.removeClass("unknown"),this.$card.removeClass(this.cardTypes.join(" ")),this.$card.addClass(n),this.$card.toggleClass("identified","unknown"!==n),this.cardType=n)},flipCard:function(){return this.$card.toggleClass("flipped")},captureName:function(t,e){var n,o,s;return s=e.which||e.keyCode,o=[48,49,50,51,52,53,54,55,56,57,106,107,109,110,111,186,187,188,189,190,191,192,219,220,221,222],n=[189,109,190,110,222],-1===o.indexOf(s)||!e.shiftKey&&i.call(n,s)>=0?void 0:e.preventDefault()}},e.fn.bindVal=function(t,n){var i,o,s,r,a;return null==n&&(n={}),n.fill=n.fill||!1,n.filters=n.filters||[],n.filters instanceof Array||(n.filters=[n.filters]),n.join=n.join||"","function"!=typeof n.join&&(s=n.join,n.join=function(){return s}),i=e(this),a=function(){var e,n,i;for(i=[],o=e=0,n=t.length;n>e;o=++e)r=t[o],i.push(t.eq(o).text());return i}(),i.on("focus",function(){return t.addClass("focused")}),i.on("blur",function(){return t.removeClass("focused")}),i.on("keyup change paste",function(){var s,l,c,u,h,d,p,f,g,m;for(u=i.map(function(){return e(this).val()}).get(),l=n.join(u),u=u.join(l),u===l&&(u=""),g=n.filters,h=0,p=g.length;p>h;h++)s=g[h],u=s(u,i,t);for(m=[],o=d=0,f=t.length;f>d;o=++d)r=t[o],c=n.fill?u+a[o].substring(u.length):u||a[o],m.push(t.eq(o).text(c));return m}),i},t}(),e.fn.extend({card:function(){var t,i;return i=arguments[0],t=2<=arguments.length?o.call(arguments,1):[],this.each(function(){var o,s;return o=e(this),s=o.data("card"),s||o.data("card",s=new n(this,i)),"string"==typeof i?s[i].apply(s,t):void 0})}})},{"jquery.payment":1}]},{},[2])(2)});